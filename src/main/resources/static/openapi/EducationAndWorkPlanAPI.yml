openapi: 3.0.0
info:
  title: Education and Work Plan API
  version: '1.4.3'
  description: Education and Work Plan API
  contact:
    name: Matt Wills
    email: matt.wills@digital.justice.gov.uk
servers:
  - url: 'http://localhost:3000'
#
# --------------------------------------------------------------------------------
#
paths:
  #
  # --------------------------------------------------------------------------------
  # RESTful style endpoints start here
  # --------------------------------------------------------------------------------
  #

  #
  # Action Plans
  # --------------------------------------------------------------------------------
  '/action-plans':
    post:
      summary: Retrieves a list of Action Plans for a given list of Prisoners.
      description: Retrieves a list of Action Plans for a given list of Prisoners. This is a POST, rather than a GET, to allow a long list of prison numbers.
      tags:
        - Action Plan
      responses:
        '200':
          $ref: '#/components/responses/ActionPlanSummaryList'
        '400':
          $ref: '#/components/responses/400ErrorResponse'
      operationId: get-action-plans
      requestBody:
        $ref: '#/components/requestBodies/GetActionPlanSummaries'

  '/action-plans/{prisonNumber}':
    parameters:
      - name: prisonNumber
        description: The number of the Prisoner who may have created (or is in the process of creating) an "Action Plan", consisting of one or more Goals. The prisonNumber is the unique identifier of the Action Plan.
        schema:
          type: string
        example: 'A1234BC'
        in: path
        required: true
    post:
      summary: Creates an Action Plan.
      description: Creates an Action Plan with at least one or more Goals.
      tags:
        - Action Plan
      responses:
        '201':
          description: The Action Plan was created successfully.
        '400':
          $ref: '#/components/responses/400ErrorResponse'
        '404':
          $ref: '#/components/responses/404ErrorResponse'
      operationId: create-action-plan
      requestBody:
        $ref: '#/components/requestBodies/CreateActionPlan'
    get:
      summary: Return a Prisoner's Action Plan
      description: Return a Prisoner's Action Plan with the goals ordered in chronological order (oldest first). If the prisoner does not yet have any goals set, then an Action Plan with no goals (empty array) is returned.
      tags:
        - Action Plan
      responses:
        '200':
          $ref: '#/components/responses/ActionPlan'
      operationId: get-action-plan-by-prison-number

  #
  # Goals
  # --------------------------------------------------------------------------------
  '/action-plans/{prisonNumber}/goals':
    parameters:
      - name: prisonNumber
        description: The number of the Prisoner who may have created (or is in the process of creating) an "Action Plan", consisting of one or more Goals. The prisonNumber is the unique identifier of the Action Plan.
        schema:
          type: string
        example: 'A1234BC'
        in: path
        required: true
    post:
      summary: Creates one or more Goals.
      description: Creates one or more Goals and saves them to the Prisoner's Action Plan (the latter will be created if it doesn't already exist).
      tags:
        - Goals
      responses:
        '201':
          description: The Goal(s) were created successfully.
        '400':
          $ref: '#/components/responses/400ErrorResponse'
        '404':
          $ref: '#/components/responses/404ErrorResponse'
      operationId: create-goals
      requestBody:
        $ref: '#/components/requestBodies/CreateGoals'

  '/action-plans/{prisonNumber}/goals/{goalReference}':
    parameters:
      - name: prisonNumber
        description: The number of the Prisoner who owns the Goal.
        schema:
          type: string
        example: 'A1234BC'
        in: path
        required: true
      - name: goalReference
        description: The Goal's unique reference
        schema:
          type: string
          format: uuid
        example: 'c88a6c48-97e2-4c04-93b5-98619966447b'
        in: path
        required: true
    put:
      summary: Updates a Goal
      description: Updates a single Goal and its list of Steps (including their sequential order if relevant). Note that the whole of a Goal's data should be provided, otherwise the absence of any data (such as a Step) will result in it being removed.
      tags:
        - Goals
      responses:
        '204':
          description: The Goal was updated successfully.
        '400':
          $ref: '#/components/responses/400ErrorResponse'
        '404':
          $ref: '#/components/responses/404ErrorResponse'
      operationId: update-goal
      requestBody:
        $ref: '#/components/requestBodies/UpdateGoal'

  #
  # Timeline
  #
  '/timelines/{prisonNumber}':
    parameters:
      - name: prisonNumber
        description: The number of the Prisoner who may have relevant Timeline data.
        schema:
          type: string
        example: 'A1234BC'
        in: path
        required: true
    get:
      summary: Return a Prisoner's Timeline.
      description: Returns a Prisoner's Timeline data, consisting of one or more 'events' of interest in chronological order. For example, it could include events such as when they completed an Induction, or updated a Goal. The prisonNumber is the unique identifier of the Timeline.
      tags:
        - Timeline
      responses:
        '200':
          $ref: '#/components/responses/Timeline'
        '404':
          $ref: '#/components/responses/404ErrorResponse'
      operationId: get-timeline-by-prison-number

    #
    # CIAG Inductions (Inherited from the CIAG Team)
    #
  '/ciag-inductions/{prisonNumber}':
    parameters:
      - name: prisonNumber
        description: The number of the Prisoner who may have relevant Induction data.
        schema:
          type: string
        example: 'A1234BC'
        in: path
        required: true
    post:
      summary: Creates an Induction for a Prisoner.
      description: |
        Creates an Induction for a Prisoner (if it does not already exist). This endpoint has been migrated from the
        `hmpps-ciag-careers-induction-api` and the data structure has been kept the same in order to prevent breaking
        the UI when it is ports to this endpoint.
      tags:
        - Induction
      responses:
        '201':
          description: The Induction was created successfully.
        '400':
          $ref: '#/components/responses/400ErrorResponse'
      operationId: create-ciag-prisoner-induction
      requestBody:
        $ref: '#/components/requestBodies/CreateCiagInduction'
    get:
      summary: Return a Prisoner's Induction.
      description: | 
        Returns a Prisoner's Induction. Note that the response body (`CiagInduction`) matches the equivalent endpoint in the
        `hmpps-ciag-careers-induction-api`. This is to maintain compatibility for when the CIAG UI migrates to use this API instead.
      tags:
        - Induction
      responses:
        '200':
          $ref: '#/components/responses/CiagInduction'
        '404':
          $ref: '#/components/responses/404ErrorResponse'
      operationId: get-ciag-prisoner-induction

#
# --------------------------------------------------------------------------------
#
components:
  #
  # Schema and Enum Definitions
  # --------------------------------------------------------------------------------
  schemas:
    ErrorResponse:
      title: ErrorResponse
      description: |
        A generic response body object describing errors in a web request, and can be used to communicate several
        different types of error condition such as (but not limited to) `400 BAD REQUEST`, `409 CONFLICT` etc.
      properties:
        status:
          description: The HTTP status code.
          type: integer
          example: 400
        errorCode:
          description: An optional application specific error code.
          type: string
        userMessage:
          description: An optional human readable description of the error.
          type: string
          example: 'No Action Plan found for prisoner [A1234BC]'
        developerMessage:
          description: An optional error message that may have more technical information for developers.
          type: string
        moreInfo:
          description: Optional more detailed information about the error.
          type: string
      required:
        - status
    ActionPlanSummaryListResponse:
      title: ActionPlanSummaryListResponse
      type: object
      description: Contains a list of Action Plan summaries.
      properties:
        actionPlanSummaries:
          type: array
          description: A List of prisoners' Action Plan summaries. Can be empty but not null.
          items:
            $ref: '#/components/schemas/ActionPlanSummaryResponse'
      required:
        - actionPlanSummaries
    ActionPlanSummaryResponse:
      title: ActionPlanSummaryResponse
      type: object
      description: A subset of data regarding a prisoner's Action plan.
      properties:
        reference:
          type: string
          format: uuid
          description: The Action Plan's unique reference
          example: 814ade0a-a3b2-46a3-862f-79211ba13f7b
        prisonNumber:
          type: string
          description: The ID of the prisoner
          example: 'A1234BC'
        reviewDate:
          type: string
          format: date
          description: An optional ISO-8601 date representing when the Action Plan is up for review.
          example: '2024-12-19'
      required:
        - reference
        - prisonNumber
    ActionPlanResponse:
      title: ActionPlanResponse
      type: object
      description: A Prisoner's Action Plan containing a list of one or more Goals.
      properties:
        reference:
          type: string
          format: uuid
          description: The Action Plan's unique reference
          example: 814ade0a-a3b2-46a3-862f-79211ba13f7b
        prisonNumber:
          type: string
          description: The ID of the prisoner
          example: 'A1234BC'
        reviewDate:
          type: string
          format: date
          description: An optional ISO-8601 date representing when the Action Plan is up for review.
          example: '2024-12-19'
        goals:
          type: array
          description: A List of at least one or more Goals.
          items:
            $ref: '#/components/schemas/GoalResponse'
      required:
        - reference
        - prisonNumber
        - goals
    GoalResponse:
      title: GoalResponse
      type: object
      description: An individual Goal that a Prisoner aims to complete as part of their Action Plan. The goal will be active to start with.
      properties:
        goalReference:
          type: string
          format: uuid
          description: The Goal's unique reference
          example: c88a6c48-97e2-4c04-93b5-98619966447b
        title:
          type: string
          description: A title explaining the aim of the goal.
          example: Improve communication skills
        targetCompletionDate:
          type: string
          format: date
          description: An optional ISO-8601 date representing the target completion date of the Goal.
          example: '2023-12-19'
        status:
          $ref: '#/components/schemas/GoalStatus'
        steps:
          type: array
          minItems: 1
          description: A List of at least one Step.
          items:
            $ref: '#/components/schemas/StepResponse'
        notes:
          type: string
          description: Some additional notes related to the Goal.
          example: Pay close attention to Peter's behaviour.
        createdBy:
          type: string
          description: The DPS username of the person who created the goal.
          example: 'asmith_gen'
        createdByDisplayName:
          type: string
          description: The display name of the person who created the goal.
          example: 'Alex Smith'
        createdAt:
          type: string
          format: date-time
          description: An ISO-8601 timestamp representing when the Goal was created.
          example: '2023-06-19T09:39:44Z'
        createdAtPrison:
          type: string
          description: The identifier of the prison that the prisoner was resident at when the Goal was created.
          example: 'BXI'
        updatedBy:
          type: string
          description: The DPS username of the person who last updated the goal.
          example: 'asmith_gen'
        updatedByDisplayName:
          type: string
          description: The display name of the person who last updated the goal.
          example: 'Alex Smith'
        updatedAt:
          type: string
          format: date-time
          description: An ISO-8601 timestamp representing when the Goal was last updated. This will be the same as the created date if it has not yet been updated.
          example: '2023-06-19T09:39:44Z'
        updatedAtPrison:
          type: string
          description: The identifier of the prison that the prisoner was resident at when the Goal was updated.
          example: 'BXI'
      required:
        - goalReference
        - title
        - targetCompletionDate
        - status
        - steps
        - createdBy
        - createdByDisplayName
        - createdAt
        - createdAtPrison
        - updatedBy
        - updatedByDisplayName
        - updatedAt
        - updatedAtPrison
    StepResponse:
      title: StepResponse
      type: object
      description: A Step within a Goal that must be completed in order for the overall Goal to be completed.
      properties:
        stepReference:
          type: string
          format: uuid
          description: A unique reference for the Step
          example: d38a6c41-13d1-1d05-13c2-24619966119b
        title:
          type: string
          description: A title describing the step
          example: Book communication skills course
        status:
          $ref: '#/components/schemas/StepStatus'
        sequenceNumber:
          type: integer
          description: The number (position) of the Step within the overall Goal.
          example: 1
      required:
        - stepReference
        - title
        - status
        - sequenceNumber
    TimelineResponse:
      title: TimelineResponse
      type: object
      description: A Prisoner's Timeline consisting of one or more 'events' of interest in chronological order. For example, it could include events such as when they completed an Induction, or completed a Goal.
      properties:
        reference:
          type: string
          format: uuid
          description: The Timeline's unique reference.
          example: c88a6c48-97e2-4c04-93b5-98619966447b
        prisonNumber:
          type: string
          description: The ID of the prisoner.
          example: 'A1234BC'
        events:
          type: array
          minItems: 1
          description: A List of at least one TimelineEventResponse.
          items:
            $ref: '#/components/schemas/TimelineEventResponse'
      required:
        - reference
        - prisonNumber
        - events
    TimelineEventResponse:
      title: TimelineEventResponse
      type: object
      description: An 'event' of interest that has occurred during a Prisoner's time in Prison. For example, it could be when they completed an Induction, or created a Goal.
      properties:
        reference:
          type: string
          format: uuid
          description: The Timeline event's unique reference
          example: c88a6c48-97e2-4c04-93b5-98619966447b
        sourceReference:
          type: string
          description: A reference to the originating entity that was created, or updated during this event, such as a Prisoner's Goal or Induction. Typically this will be a UUID, but does not have to be.
          example: c88a6c48-97e2-4c04-93b5-98619966447b
        eventType:
          $ref: '#/components/schemas/TimelineEventType'
        contextualInfo:
          type: string
          description: Contextual information that's relevant to the event in question. For example the title of a Goal that was completed.
          example: 'Learn French'
        prisonId:
          type: string
          description: The identifier of the prison that the prisoner was at when the event occurred.
          example: BXI
        actionedBy:
          type: string
          description: The username of the person who caused this event. Set to 'system' if the event was not actioned by a DPS user.
          example: 'asmith_gen'
        actionedByDisplayName:
          type: string
          description: The display name of the person who caused this event, if applicable.
          example: 'Alex Smith'
        timestamp:
          type: string
          format: date-time
          description: An ISO-8601 timestamp representing when the event occurred.
          example: '2023-06-19T09:39:44Z'
        correlationId:
          type: string
          format: uuid
          description: A correlationId for this and any other TimelineEvents that occurred at the same time (i.e. within same atomic action). For example, this could be an update to a Goal, plus one or more of its child Steps. If required, this allows a client to easily group the events together.
          example: 113d1833-0ce1-45ad-ab44-878c9d589358
      required:
        - reference
        - sourceReference
        - eventType
        - prisonId
        - actionedBy
        - timestamp
        - correlationId
    CiagInductionResponse:
      title: CiagInductionResponse
      type: object
      description: A Prisoner's CIAG Induction containing information, such as their education history and future work interests.
      properties:
        reference:
          type: string
          format: uuid
          description: The Induction's unique reference.
          example: 814ade0a-a3b2-46a3-862f-79211ba13f7b
        offenderId:
          pattern: "^[A-Z]\\d{4}[A-Z]{2}$"
          type: string
          description: 'The ID of the Prisoner. AKA the prison number.'
        prisonId:
          type: string
          description: The ID of the Prison that that Prisoner is currently at.
        prisonName:
          type: string
          description: The name of the Prison that that Prisoner is currently at.
        hopingToGetWork:
          $ref: '#/components/schemas/HopingToWork'
        desireToWork:
          type: boolean
          description: Whether the Prisoner wishes to work or not.
        reasonToNotGetWorkOther:
          type: string
          description: The reason that is given when the Prisoner does not want to work. This is mandatory when 'reasonToNotGetWork' is set to 'OTHER'.
        abilityToWork:
          uniqueItems: true
          type: array
          description: One or more factors affecting the Prisoner's ability to work.
          items:
            $ref: '#/components/schemas/AbilityToWorkFactor'
        abilityToWorkOther:
          type: string
          description: A specific factor affecting the Prisoner's ability to work. This is mandatory when 'abilityToWork' is set to 'OTHER'.
        reasonToNotGetWork:
          uniqueItems: true
          type: array
          description: One or more reasons the Prisoner has given not to get work after leaving Prison.
          items:
            $ref: '#/components/schemas/ReasonNotToWork'
        workExperience:
          "$ref": "#/components/schemas/PreviousWorkResponse"
        skillsAndInterests:
          "$ref": "#/components/schemas/SkillsAndInterestsResponse"
        qualificationsAndTraining:
          "$ref": "#/components/schemas/EducationAndQualificationResponse"
        inPrisonInterests:
          "$ref": "#/components/schemas/PrisonWorkAndEducationResponse"
        createdBy:
          type: string
          description: The DPS username of the person who created the Induction.
          example: 'asmith_gen'
        createdDateTime:
          type: string
          format: date-time
          description: An ISO-8601 timestamp representing when the Induction was created.
          example: '2023-06-19T09:39:44Z'
        modifiedBy:
          type: string
          description: The DPS username of the person who last updated the Induction.
          example: 'asmith_gen'
        modifiedDateTime:
          type: string
          format: date-time
          description: An ISO-8601 timestamp representing when the Goal was last updated. This will be the same as the created date if it has not yet been updated.
          example: '2023-06-19T09:39:44Z'
      required:
        - reference
        - offenderId
        - hopingToGetWork
        - createdBy
        - createdDateTime
        - modifiedBy
        - modifiedDateTime
    PreviousWorkResponse:
      title: PreviousWorkResponse
      description: A Prisoner's previous work experience. Migrated from hmpps-ciag-careers-induction-api.
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: A unique reference for this Prisoner's previous work experience (not the database primary key).
          example: c88a6c48-97e2-4c04-93b5-98619966447b
        hasWorkedBefore:
          type: boolean
        typeOfWorkExperience:
          minItems: 1
          uniqueItems: true
          type: array
          description: A list of the Prisoner's type of previous work experience.
          items:
            $ref: '#/components/schemas/WorkType'
        typeOfWorkExperienceOther:
          type: string
          description: A specific work experience type for the Prisoner. Mandatory when 'typeOfWorkExperience' includes 'OTHER'.
        workExperience:
          minItems: 1
          uniqueItems: true
          type: array
          description: A list of the Prisoner's previous work experience details.
          items:
            $ref: '#/components/schemas/WorkExperience'
        workInterests:
          $ref: '#/components/schemas/WorkInterests'
        modifiedBy:
          type: string
          description: The DPS username of the person who last updated this Prisoner's previous work.
          example: 'asmith_gen'
        modifiedDateTime:
          type: string
          format: date-time
          description: An ISO-8601 timestamp representing when this Prisoner's previous work was last updated. This will be the same as the created date if it has not yet been updated.
          example: '2023-06-19T09:39:44Z'
      required:
        - hasWorkedBefore
        - modifiedBy
        - modifiedDateTime
    SkillsAndInterestsResponse:
      title: SkillsAndInterestsResponse
      description: Represents the personal skills and interests of a Prisoner. Migrated from hmpps-ciag-careers-induction-api.
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: A unique reference for this Prisoner's skills and interests (not the database primary key).
          example: c88a6c48-97e2-4c04-93b5-98619966447b
        skills:
          minItems: 1
          uniqueItems: true
          type: array
          description: One or more skills that the Prisoner feels they have.
          items:
            $ref: '#/components/schemas/PersonalSkill'
        skillsOther:
          type: string
          description: A specific type of a skill that the Prisoner feels they have. Mandatory when 'skills' includes 'OTHER'.
        personalInterests:
          minItems: 1
          uniqueItems: true
          type: array
          description: One or more interests that the Prisoner feels they have.
          items:
            $ref: '#/components/schemas/PersonalInterest'
        personalInterestsOther:
          type: string
          description: A specific type of a interest that the Prisoner feels they have. Mandatory when 'personalInterests' includes 'OTHER'.
        modifiedBy:
          type: string
          description: The DPS username of the person who last updated this Prisoner's skills and interests.
          example: 'asmith_gen'
        modifiedDateTime:
          type: string
          format: date-time
          description: An ISO-8601 timestamp representing when this Prisoner's skills and interests was last updated. This will be the same as the created date if it has not yet been updated.
          example: '2023-06-19T09:39:44Z'
      required:
        - hasWorkedBefore
        - modifiedBy
        - modifiedDateTime
    EducationAndQualificationResponse:
      title: EducationAndQualificationResponse
      type: object
      description: A Prisoner's education and qualifications history. Migrated from hmpps-ciag-careers-induction-api.
      properties:
        id:
          type: string
          format: uuid
          description: A unique reference for this Prisoner's education and qualifications (not the database primary key).
          example: c88a6c48-97e2-4c04-93b5-98619966447b
        educationLevel:
          $ref: '#/components/schemas/HighestEducationLevel'
        qualifications:
          uniqueItems: true
          type: array
          description: A list of the Prisoner's previous qualifications
          items:
            $ref: '#/components/schemas/AchievedQualification'
        additionalTraining:
          uniqueItems: true
          type: array
          description: Any additional training that the Prisoner has completed in the past.
          items:
            $ref: '#/components/schemas/TrainingType'
        additionalTrainingOther:
          type: string
          description: A specific type of training that does not fit the given 'additionalTraining' types. Mandatory when 'additionalTraining' includes 'OTHER'.
        modifiedBy:
          type: string
          description: The DPS username of the person who last updated this Prisoner's education and qualifications.
          example: 'asmith_gen'
        modifiedDateTime:
          type: string
          format: date-time
          description: An ISO-8601 timestamp representing when this Prisoner's education and qualifications was last updated. This will be the same as the created date if it has not yet been updated.
          example: '2023-06-19T09:39:44Z'
      required:
        - modifiedBy
        - modifiedDateTime
    PrisonWorkAndEducationResponse:
      description: A Prisoner's in-prison work and education interests. Migrated from hmpps-ciag-careers-induction-api.
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: A unique reference for this Prisoner's in-prison work and education interests (not the database primary key).
          example: c88a6c48-97e2-4c04-93b5-98619966447b
        inPrisonWork:
          minItems: 1
          uniqueItems: true
          type: array
          description: A list of in-prison work that the Prisoner is interested in.
          items:
            $ref: '#/components/schemas/InPrisonWorkType'
        inPrisonWorkOther:
          type: string
          description: A specific type of in-prison work that does not fit the given 'inPrisonWork' types. Mandatory when 'inPrisonWork' includes 'OTHER'.
        inPrisonEducation:
          minItems: 1
          uniqueItems: true
          type: array
          description: Any potential in-prison education/training that the Prisoner is interested in.
          items:
            $ref: '#/components/schemas/InPrisonTrainingType'
        inPrisonEducationOther:
          type: string
          description: A specific type of in-prison education/training that does not fit the given 'inPrisonEducation' types. Mandatory when 'inPrisonEducation' includes 'OTHER'.
        modifiedBy:
          type: string
          description: The DPS username of the person who last updated this Prisoner's in-prison work and education interests.
          example: 'asmith_gen'
        modifiedDateTime:
          type: string
          format: date-time
          description: An ISO-8601 timestamp representing when this Prisoner's in-prison work and education interests was last updated. This will be the same as the created date if it has not yet been updated.
          example: '2023-06-19T09:39:44Z'
      required:
        - modifiedBy
        - modifiedDateTime

    GetActionPlanSummariesRequest:
      title: GetActionPlanSummariesRequest
      type: object
      description: A request to retrieve a list of Action Plan summaries for at least one prisoner.
      properties:
        prisonNumbers:
          type: array
          description: A List of at least one prison number.
          minItems: 1
          items:
            type: string
      required:
        - prisonNumbers

    CreateActionPlanRequest:
      title: CreateActionPlanRequest
      type: object
      description: A request to create an Action Plan with at least one or more Goals that a Prisoner aims to complete.
      allOf:
        - $ref: '#/components/schemas/CreateGoalsRequest'
      properties:
        reviewDate:
          type: string
          format: date
          x-constraints: 'NotInPast'
          description: An optional ISO-8601 date representing when the Action Plan is up for review.
          example: '2023-12-19'

    CreateGoalRequest:
      title: CreateGoalRequest
      type: object
      description: A request to create an individual Goal that a Prisoner aims to complete as part of their Action Plan. The goal's status will be set to 'ACTIVE'.
      properties:
        title:
          type: string
          description: A title explaining the aim of the goal.
          example: Improve communication skills
        targetCompletionDate:
          type: string
          format: date
          x-constraints: 'NotInPast'
          description: An optional ISO-8601 date representing the target completion date of the Goal.
          example: '2023-12-19'
        steps:
          type: array
          minItems: 1
          description: A List of at least one Step.
          items:
            $ref: '#/components/schemas/CreateStepRequest'
        notes:
          type: string
          description: Some additional notes related to the Goal.
          example: Pay close attention to Peter's behaviour.
        prisonId:
          type: string
          description: The identifier of the prison that the prisoner is currently resident at.
          example: BXI
      required:
        - title
        - targetCompletionDate
        - steps
        - prisonId

    CreateGoalsRequest:
      title: CreateGoalsRequest
      type: object
      description: A request to create one or more Goals that a Prisoner aims to complete as part of their Action Plan. The status of each goal will be set to 'ACTIVE'.
      properties:
        goals:
          type: array
          minItems: 1
          description: A List of at least one Goal.
          items:
            $ref: '#/components/schemas/CreateGoalRequest'
      required:
        - goals

    UpdateGoalRequest:
      title: UpdateGoalRequest
      type: object
      description: A request to update an individual Goal that a Prisoner aims to complete as part of their Action Plan.
      properties:
        goalReference:
          type: string
          format: uuid
          description: The Goal's unique reference. This is used as an identifier to update the required Goal. It is not possible or supported to update the `goalReference`.
          example: c88a6c48-97e2-4c04-93b5-98619966447b
        title:
          type: string
          description: A title explaining the aim of the goal.
          example: Improve communication skills
        targetCompletionDate:
          type: string
          format: date
          description: An optional ISO-8601 date representing the target completion date of the Goal.
          example: '2023-12-19'
        status:
          $ref: '#/components/schemas/GoalStatus'
        steps:
          type: array
          minItems: 1
          description: A List of at least one Step.
          items:
            $ref: '#/components/schemas/UpdateStepRequest'
        notes:
          type: string
          description: Some additional notes related to the Goal.
          example: Pay close attention to Peter's behaviour.
        prisonId:
          type: string
          description: The identifier of the prison that the prisoner is currently resident at.
          example: BXI
      required:
        - goalReference
        - title
        - targetCompletionDate
        - status
        - steps
        - prisonId

    CreateStepRequest:
      title: CreateStepRequest
      type: object
      description: A request to create a Step within a Goal. Note that new Steps are created with an implicit status of NOT_STARTED.
      properties:
        title:
          type: string
          description: A title describing the step
          example: Book first aid course
        sequenceNumber:
          type: integer
          description: The number (position) of the Step within the overall Goal.
          example: 1
      required:
        - title
        - sequenceNumber

    UpdateStepRequest:
      title: UpdateStepRequest
      type: object
      description: A request to update a Step within a Goal.
      allOf:
        - $ref: '#/components/schemas/CreateStepRequest'
      properties:
        stepReference:
          type: string
          format: uuid
          description: |
            Optional reference number for the Step.
            The Step's unique reference. This is used as an identifier to update the required Step. It is not possible or supported to update the `stepReference` for an existing step.
            If the Step reference is not supplied this will be treated as a new Step and will be added to the Goal.
          example: d38a6c41-13d1-1d05-13c2-24619966119b
        status:
          $ref: '#/components/schemas/StepStatus'
      required:
        - status

    GoalStatus:
      title: GoalStatus
      description: Enum describing the various statuses of a Goal's lifecycle.
      type: string
      enum:
        - ACTIVE
        - COMPLETED
        - ARCHIVED
    StepStatus:
      title: StepStatus
      description: Enum describing the various statuses of a Step's lifecycle.
      type: string
      enum:
        - NOT_STARTED
        - ACTIVE
        - COMPLETE
    TimelineEventType:
      title: TimelineEventType
      description: The type of a Timeline Event.
      type: string
      enum:
        - INDUCTION_CREATED
        - INDUCTION_UPDATED
        - ACTION_PLAN_CREATED
        - GOAL_CREATED
        - GOAL_UPDATED
        - GOAL_STARTED
        - GOAL_COMPLETED
        - GOAL_ARCHIVED
        - STEP_UPDATED
        - STEP_NOT_STARTED
        - STEP_STARTED
        - STEP_COMPLETED

    CreateCiagInductionRequest:
      title: CreateCiagInductionRequest
      description: A request to create a CIAG Induction. Migrated from hmpps-ciag-careers-induction-api.
      type: object
      properties:
        prisonId:
          type: string
          description: The ID of the Prison that that Prisoner is currently at.
        prisonName:
          type: string
          description: The name of the Prison that that Prisoner is currently at.
        hopingToGetWork:
          $ref: '#/components/schemas/HopingToWork'
        reasonToNotGetWorkOther:
          type: string
          description: The reason that is given when the Prisoner does not want to work. This is mandatory when 'reasonToNotGetWork' is set to 'OTHER'.
        abilityToWork:
          uniqueItems: true
          type: array
          description: One or more factors affecting the Prisoner's ability to work.
          items:
            $ref: '#/components/schemas/AbilityToWorkFactor'
        abilityToWorkOther:
          type: string
          description: A specific factor affecting the Prisoner's ability to work. This is mandatory when 'abilityToWork' is set to 'OTHER'.
        reasonToNotGetWork:
          uniqueItems: true
          type: array
          description: One or more reasons the Prisoner has given not to get work after leaving Prison.
          items:
            $ref: '#/components/schemas/ReasonNotToWork'
        workExperience:
          $ref: '#/components/schemas/PreviousWorkRequest'
        skillsAndInterests:
          $ref: '#/components/schemas/SkillsAndInterestsRequest'
        qualificationsAndTraining:
          $ref: '#/components/schemas/EducationAndQualificationsRequest'
        inPrisonInterests:
          $ref: '#/components/schemas/PrisonWorkAndEducationRequest'
      required:
        - hopingToGetWork
        - prisonId

    PreviousWorkRequest:
      description: A request to persist the previous work experience of the Prisoner. Migrated from hmpps-ciag-careers-induction-api.
      type: object
      properties:
        hasWorkedBefore:
          type: boolean
        typeOfWorkExperience:
          minItems: 1
          uniqueItems: true
          type: array
          description: A list of the Prisoner's type of previous work experience.
          items:
            $ref: '#/components/schemas/WorkType'
        typeOfWorkExperienceOther:
          type: string
          description: A specific work experience type for the Prisoner. Mandatory when 'typeOfWorkExperience' includes 'OTHER'.
        workExperience:
          minItems: 1
          uniqueItems: true
          type: array
          description: A list of the Prisoner's previous work experience details.
          items:
            $ref: '#/components/schemas/WorkExperience'
        workInterests:
          $ref: '#/components/schemas/WorkInterests'
      required:
        - hasWorkedBefore

    SkillsAndInterestsRequest:
      description: A request to persist a Prisoner's personal skills and interests. Migrated from hmpps-ciag-careers-induction-api.
      type: object
      properties:
        skills:
          minItems: 1
          uniqueItems: true
          type: array
          description: One or more skills that the Prisoner feels they have.
          items:
            $ref: '#/components/schemas/PersonalSkill'
        skillsOther:
          type: string
          description: A specific type of a skill that the Prisoner feels they have. Mandatory when 'skills' includes 'OTHER'.
        personalInterests:
          minItems: 1
          uniqueItems: true
          type: array
          description: One or more interests that the Prisoner feels they have.
          items:
            $ref: '#/components/schemas/PersonalInterest'
        personalInterestsOther:
          type: string
          description: A specific type of a interest that the Prisoner feels they have. Mandatory when 'personalInterests' includes 'OTHER'.

    EducationAndQualificationsRequest:
      description: A request to persist a Prisoner's education and qualifications. Migrated from hmpps-ciag-careers-induction-api.
        the inmate.
      type: object
      properties:
        educationLevel:
          $ref: '#/components/schemas/HighestEducationLevel'
        qualifications:
          uniqueItems: true
          type: array
          description: A list of the Prisoner's previous qualifications
          items:
            $ref: '#/components/schemas/AchievedQualification'
        additionalTraining:
          uniqueItems: true
          type: array
          description: Any additional training that the Prisoner has completed in the past.
          items:
            $ref: '#/components/schemas/TrainingType'
        additionalTrainingOther:
          type: string
          description: A specific type of training that does not fit the given 'additionalTraining' types. Mandatory when 'additionalTraining' includes 'OTHER'.

    PrisonWorkAndEducationRequest:
      description: A request to persist a Prisoner's in-prison work and education interests. Migrated from hmpps-ciag-careers-induction-api.
      type: object
      properties:
        inPrisonWork:
          minItems: 1
          uniqueItems: true
          type: array
          description: A list of in-prison work that the Prisoner is interested in.
          items:
            $ref: '#/components/schemas/InPrisonWorkType'
        inPrisonWorkOther:
          type: string
          description: A specific type of in-prison work that does not fit the given 'inPrisonWork' types. Mandatory when 'inPrisonWork' includes 'OTHER'.
        inPrisonEducation:
          minItems: 1
          uniqueItems: true
          type: array
          description: Any potential in-prison education/training that the Prisoner is interested in.
          items:
            $ref: '#/components/schemas/InPrisonTrainingType'
        inPrisonEducationOther:
          type: string
          description: A specific type of in-prison education/training that does not fit the given 'inPrisonEducation' types. Mandatory when 'inPrisonEducation' includes 'OTHER'.

    WorkExperience:
      description: A Prisoner's list of work experience details. Migrated from hmpps-ciag-careers-induction-api.
      type: object
      properties:
        typeOfWorkExperience:
          $ref: '#/components/schemas/WorkType'
        otherWork:
          type: string
          description: A work experience, which is not listed in 'typeOfWorkExperience' Enum. Mandatory when 'typeOfWorkExperience' includes 'OTHER'.
        role:
          type: string
          description: This is the role the Prisoner had.
        details:
          type: string
          description: Additional details of the work.
      required:
        - typeOfWorkExperience

    WorkInterests:
      description: The Prisoner's work interests. Migrated from hmpps-ciag-careers-induction-api.
      type: object
      properties:
        workInterests:
          minItems: 1
          uniqueItems: true
          type: array
          description: A list of Prisoner's future work interests.
          items:
            $ref: '#/components/schemas/WorkType'
        workInterestsOther:
          type: string
          description: A work interest, which is not listed in 'workInterests' Enum. Mandatory when 'workInterests' includes 'OTHER'.
        particularJobInterests:
          uniqueItems: true
          type: array
          description: A detailed list of work interests that a Prisoner has.
          items:
            $ref: '#/components/schemas/WorkInterestDetail'
      required:
        - workInterests

    WorkInterestDetail:
      title: WorkInterestDetail
      description: Detail about a Prisoner's work interest.
      type: object
      properties:
        workInterest:
          $ref: '#/components/schemas/WorkType'
        role:
          type: string
          description: The role within a Prisoner's area of work interest.
      required:
        - role
        - workInterest

    HopingToWork:
      title: HopingToWork
      type: string
      description: Whether the Prisoner hopes to get work.
      enum:
        - "YES"
        - "NO"
        - "NOT_SURE"

    AbilityToWorkFactor:
      title: AbilityToWorkFactor
      description: Factors affecting a prisoner's ability to work.
      type: string
      enum:
        - CARING_RESPONSIBILITIES
        - LIMITED_BY_OFFENSE
        - HEALTH_ISSUES
        - NO_RIGHT_TO_WORK
        - OTHER
        - NONE

    ReasonNotToWork:
      title: ReasonNotToWork
      type: string
      description: Reasons the Prisoner has given not to get work after leaving Prison.
      enum:
        - LIMIT_THEIR_ABILITY
        - FULL_TIME_CARER
        - LACKS_CONFIDENCE_OR_MOTIVATION
        - HEALTH
        - RETIRED
        - NO_RIGHT_TO_WORK
        - NOT_SURE
        - OTHER
        - NO_REASON

    PersonalSkill:
      title: PersonalSkill
      type: string
      description: Represents a Prisoner's personal skill.
      enum:
        - COMMUNICATION
        - POSITIVE_ATTITUDE
        - RESILIENCE
        - SELF_MANAGEMENT
        - TEAMWORK
        - THINKING_AND_PROBLEM_SOLVING
        - WILLINGNESS_TO_LEARN
        - OTHER
        - NONE

    PersonalInterest:
      title: PersonalInterest
      type: string
      description: Represents a Prisoner's personal interest.
      enum:
        - COMMUNITY
        - CRAFTS
        - CREATIVE
        - DIGITAL
        - KNOWLEDGE_BASED
        - MUSICAL
        - OUTDOOR
        - NATURE_AND_ANIMALS
        - SOCIAL
        - SOLO_ACTIVITIES
        - SOLO_SPORTS
        - TEAM_SPORTS
        - WELLNESS
        - OTHER
        - NONE

    HighestEducationLevel:
      title: HighestEducationLevel
      type: string
      description: The highest education level of a Prisoner.
      enum:
        - PRIMARY_SCHOOL
        - SECONDARY_SCHOOL_LEFT_BEFORE_TAKING_EXAMS
        - SECONDARY_SCHOOL_TOOK_EXAMS
        - FURTHER_EDUCATION_COLLEGE
        - UNDERGRADUATE_DEGREE_AT_UNIVERSITY
        - POSTGRADUATE_DEGREE_AT_UNIVERSITY
        - NOT_SURE

    TrainingType:
      title: TrainingType
      type: string
      description: Additional training types that a Prisoner may have done.
      enum:
        - CSCS_CARD
        - FIRST_AID_CERTIFICATE
        - FOOD_HYGIENE_CERTIFICATE
        - FULL_UK_DRIVING_LICENCE
        - HEALTH_AND_SAFETY
        - HGV_LICENCE
        - MACHINERY_TICKETS
        - MANUAL_HANDLING
        - TRADE_COURSE
        - OTHER
        - NONE

    InPrisonWorkType:
      title: InPrisonWorkType
      type: string
      description: Types of work that can be done whilst in prison.
      enum:
        - CLEANING_AND_HYGIENE
        - COMPUTERS_OR_DESK_BASED
        - GARDENING_AND_OUTDOORS
        - KITCHENS_AND_COOKING
        - MAINTENANCE
        - PRISON_LAUNDRY
        - PRISON_LIBRARY
        - TEXTILES_AND_SEWING
        - WELDING_AND_METALWORK
        - WOODWORK_AND_JOINERY
        - OTHER

    InPrisonTrainingType:
      title: InPrisonTrainingType
      type: string
      description: The types of training that can be done whilst in prison.
      enum:
        - BARBERING_AND_HAIRDRESSING
        - CATERING
        - COMMUNICATION_SKILLS
        - ENGLISH_LANGUAGE_SKILLS
        - FORKLIFT_DRIVING
        - INTERVIEW_SKILLS
        - MACHINERY_TICKETS
        - NUMERACY_SKILLS
        - RUNNING_A_BUSINESS
        - SOCIAL_AND_LIFE_SKILLS
        - WELDING_AND_METALWORK
        - WOODWORK_AND_JOINERY
        - OTHER

    WorkType:
      title: WorkType
      description: The various categories of work that a Prisoner may have worked in, or be interested in working in the future.
      type: string
      enum:
        - OUTDOOR
        - CONSTRUCTION
        - DRIVING
        - BEAUTY
        - HOSPITALITY
        - TECHNICAL
        - MANUFACTURING
        - OFFICE
        - RETAIL
        - SPORTS
        - WAREHOUSING
        - WASTE_MANAGEMENT
        - EDUCATION_TRAINING
        - CLEANING_AND_MAINTENANCE
        - OTHER

    AchievedQualification:
      title: AchievedQualification
      type: object
      description: A qualification that a Prisoner has achieved.
      properties:
        subject:
          type: string
          description: The subject of the qualification.
        level:
          type: string
          description: The level of the qualification (if known/relevant).
          enum:
            - ENTRY_LEVEL_2
            - ENTRY_LEVEL_3
            - LEVEL_1
            - LEVEL_2
            - LEVEL_3
            - LEVEL_4
            - LEVEL_5
            - LEVEL_6
            - LEVEL_7
            - LEVEL_8
        grade:
          type: string
          description: The grade which was achieved (if known/relevant).

  #
  # Response Body Definitions
  # --------------------------------------------------------------------------------
  responses:
    400ErrorResponse:
      description: Error response for a HTTP 400 describing fields in the request payload that are in error.
      headers:
        Access-Control-Allow-Origin:
          schema:
            type: string
        Access-Control-Allow-Methods:
          schema:
            type: string
        Access-Control-Allow-Headers:
          schema:
            type: string
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            status: 400
            userMessage: 'Error on field goal.targetCompletionDate: rejected value [2023-06-01] cannot be in the past'
    404ErrorResponse:
      description: |
        Error response for a HTTP 404 describing the problem with the request.
      headers:
        Access-Control-Allow-Origin:
          schema:
            type: string
        Access-Control-Allow-Methods:
          schema:
            type: string
        Access-Control-Allow-Headers:
          schema:
            type: string
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            status: 404
            userMessage: 'The prisoner with prisonNumber=[A1234BC] not found'
    409ErrorResponse:
      description: |
        Error response for a HTTP 409 describing the problem with the request.
      headers:
        Access-Control-Allow-Origin:
          schema:
            type: string
        Access-Control-Allow-Methods:
          schema:
            type: string
        Access-Control-Allow-Headers:
          schema:
            type: string
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            status: 409
            userMessage: 'A Goal with reference [c88a6c48-97e2-4c04-93b5-98619966447b] has an unexpected status = ARCHIVED'
    ActionPlanSummaryList:
      description: Response body containing the a list of Action Plan summaries that make up a Prisoner's Action Plan.
      headers:
        Access-Control-Allow-Origin:
          schema:
            type: string
        Access-Control-Allow-Methods:
          schema:
            type: string
        Access-Control-Allow-Headers:
          schema:
            type: string
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ActionPlanSummaryListResponse'
    ActionPlan:
      description: Response body containing the Goals that make up a Prisoner's Action Plan.
      headers:
        Access-Control-Allow-Origin:
          schema:
            type: string
        Access-Control-Allow-Methods:
          schema:
            type: string
        Access-Control-Allow-Headers:
          schema:
            type: string
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ActionPlanResponse'
    Goal:
      description: Response body containing a single Goal within a Prisoner's Action Plan.
      headers:
        Access-Control-Allow-Origin:
          schema:
            type: string
        Access-Control-Allow-Methods:
          schema:
            type: string
        Access-Control-Allow-Headers:
          schema:
            type: string
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/GoalResponse'
    Timeline:
      description: Response body containing a Prisoner's Timeline.
      headers:
        Access-Control-Allow-Origin:
          schema:
            type: string
        Access-Control-Allow-Methods:
          schema:
            type: string
        Access-Control-Allow-Headers:
          schema:
            type: string
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/TimelineResponse'
    CiagInduction:
      description: Response body containing a Prisoner's CIAG Induction.
      headers:
        Access-Control-Allow-Origin:
          schema:
            type: string
        Access-Control-Allow-Methods:
          schema:
            type: string
        Access-Control-Allow-Headers:
          schema:
            type: string
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/CiagInductionResponse'

  #
  # Request Body Definitions
  # --------------------------------------------------------------------------------
  requestBodies:
    GetActionPlanSummaries:
      description: Request body to retrieve a list of Action Plan summaries for one or more Prisoners.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/GetActionPlanSummariesRequest'
    CreateActionPlan:
      description: Request body to create an Action Plan with at least one or more Goals.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/CreateActionPlanRequest'
    CreateGoals:
      description: Request body to create one or more Goals.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/CreateGoalsRequest'
    UpdateGoal:
      description: Request body to update a single Goal.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/UpdateGoalRequest'
    CreateCiagInduction:
      description: Request body to create a Prisoner's Induction.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/CreateCiagInductionRequest'
